{"version":3,"sources":["webpack:///./../js/app/exchange.js"],"names":["Loading","require","MsgBox","weixin","init","done","hideOptionMenu","winCode","openPrize","bindEvents","$","on","exchange","show","getJSON","serverPath","data","hide","console","log","success","list","result","i","length","giftID","luckydraw_gift_id","win_code","fadeIn","alert","msg","code","val","shopID","always","fail","window","location","href"],"mappings":";;;;;;;;;;;;;AAAA,KAAIA,UAAU,mBAAAC,CAAQ,CAAR,CAAd;AACA,KAAIC,SAAS,mBAAAD,CAAQ,CAAR,CAAb;AACA,KAAIE,SAAS,mBAAAF,CAAQ,CAAR,CAAb;;AAEAE,QAAOC,IAAP,GAAcC,IAAd,CAAmB,YAAM;AACxBF,YAAOG,cAAP;AACA,EAFD;;AAIA,KAAIC,UAAU,EAAd;;AAEAC;AACAC;;AAEA,UAASA,UAAT,GAAsB;AACrBC,OAAE,sBAAF,EAA0BC,EAA1B,CAA6B,OAA7B,EAAsCC,QAAtC;AACA;;AAED,UAASJ,SAAT,GAAqB;AACjBR,aAAQa,IAAR;AACAH,OAAEI,OAAF,CAAUC,aAAa,wCAAvB,EAAiEV,IAAjE,CAAsE,UAACW,IAAD,EAAU;AAC5EhB,iBAAQiB,IAAR;AACAC,iBAAQC,GAAR,CAAYH,IAAZ;AACA,aAAGA,KAAKI,OAAR,EAAiB;AACb,iBAAIC,OAAOL,KAAKM,MAAL,CAAYD,IAAvB;AACA,kBAAI,IAAIE,IAAI,CAAZ,EAAeA,IAAIF,KAAKG,MAAxB,EAAgCD,GAAhC,EAAqC;AACjC,qBAAIE,SAASJ,KAAKE,CAAL,EAAQG,iBAArB;AACA,qBAAGD,UAAU,KAAb,EAAoB;AACnBlB,+BAAUc,KAAKE,CAAL,EAAQI,QAAlB;AACA;AACJ;AACDjB,eAAE,YAAF,EAAgBkB,MAAhB;AACH,UATD,MASO;AACH1B,oBAAO2B,KAAP,CAAab,KAAKc,GAAlB;AACH;AACJ,MAfD;AAgBH;;AAED,UAASlB,QAAT,GAAoB;AACnB,SAAImB,OAAOrB,EAAE,UAAF,EAAcsB,GAAd,EAAX;AACG,SAAG,CAACD,KAAKP,MAAT,EAAiB;AACbtB,gBAAO2B,KAAP,CAAa,SAAb;AACA;AACH;AACD7B,aAAQa,IAAR;AACAH,OAAEI,OAAF,CAAUC,aAAa,uCAAvB,EAAgE;AAC5DR,kBAASA,OADmD;AAE5D0B,iBAAQF;AAFoD,MAAhE,EAGGG,MAHH,CAGU,YAAM;AACZlC,iBAAQiB,IAAR;AACH,MALD,EAKGkB,IALH,CAKQ,YAAM;AACVjC,gBAAO2B,KAAP,CAAa,UAAb;AACH,MAPD,EAOGxB,IAPH,CAOQ,UAACW,IAAD,EAAU;AACdE,iBAAQC,GAAR,CAAYH,IAAZ;AACA,aAAGA,KAAKI,OAAR,EAAiB;AACblB,oBAAO2B,KAAP,CAAa,MAAb,EAAqB,YAAW;AAC/BO,wBAAOC,QAAP,CAAgBC,IAAhB,GAAuBvB,aAAa,cAApC;AACA,cAFD;AAGH,UAJD,MAIO;AACHb,oBAAO2B,KAAP,CAAab,KAAKc,GAAlB;AACH;AACJ,MAhBD;AAiBH,E","file":"js/exchange.js","sourcesContent":["var Loading = require(\"../components/loading.js\");\r\nvar MsgBox = require(\"../components/msgbox.js\");\r\nvar weixin = require(\"../libs/weixin.js\");\r\n\r\nweixin.init().done(() => {\r\n\tweixin.hideOptionMenu();\r\n});\r\n\r\nvar winCode = '';\r\n\r\nopenPrize();\r\nbindEvents();\r\n\r\nfunction bindEvents() {\r\n\t$(\"#exchange .submitBtn\").on(\"click\", exchange);\r\n}\r\n\r\nfunction openPrize() {\r\n    Loading.show();\r\n    $.getJSON(serverPath + 'lego20170726/api/prize-list?callback=?').done((data) => {\r\n        Loading.hide();\r\n        console.log(data);\r\n        if(data.success) {\r\n            let list = data.result.list;\r\n            for(let i = 0; i < list.length; i++) {\r\n                let giftID = list[i].luckydraw_gift_id;\r\n                if(giftID == \"273\") {\r\n                \twinCode = list[i].win_code;\r\n                }\r\n            }\r\n            $(\".pop.prize\").fadeIn();\r\n        } else {\r\n            MsgBox.alert(data.msg);\r\n        }\r\n    });\r\n}\r\n\r\nfunction exchange() {\r\n\tlet code = $(\"#shopIpt\").val();\r\n    if(!code.length) {\r\n        MsgBox.alert(\"请填写门店编号\");\r\n        return;\r\n    }\r\n    Loading.show();\r\n    $.getJSON(serverPath + 'lego20170726/api/prize-get?callback=?', {\r\n        winCode: winCode,\r\n        shopID: code\r\n    }).always(() => {\r\n        Loading.hide();\r\n    }).fail(() => {\r\n        MsgBox.alert(\"网络错误 请重试\");\r\n    }).done((data) => {\r\n        console.log(data);\r\n        if(data.success) {\r\n            MsgBox.alert('核销成功', function() {\r\n            \twindow.location.href = serverPath + 'lego20170726';\r\n            });\r\n        } else {\r\n            MsgBox.alert(data.msg);\r\n        }\r\n    });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./../js/app/exchange.js"],"sourceRoot":""}